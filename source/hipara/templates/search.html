{% extends "base.html" %}

{% block title %}Rule Manager{% endblock %}


{% block content %}
<!-- Search Bar -->
<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">Search Rules</h3>
    </div>
    <div class="panel-body">
<form class="form-inline" role="form" action="/search/" method="get" name="search" target="_self">
  <div class="form-group">
      <select class="form-control" name="search_type">
        <option value="name" {% if search_type == "name" %} selected {% endif %}>Name</option>
        <option value="string" {% if search_type == "string" %} selected {% endif %}>String</option>
        <option value="meta" {% if search_type == "meta" %} selected {% endif %}>Meta Data</option>
    </select>
  </div>
  <div class="form-group">
    <label class="sr-only" for="term">Search Term</label>
    <input type="text" class="form-control" name="search_word" id="search_word" placeholder="Search Term" value="{{search_word}}">
    {% csrf_token %}
  </div>
  <button type="submit" class="btn btn-default">Search</button>

</form>

</div>
</div>

<!-- List Results -->

<!-- List Rules -->

<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">Search for: <strong><span class="text-success">'{{search_word}}' </span></strong> Returned <strong><span class="text-success">{{rule_count}}</span></strong> Results</h3>
    </div>

    <table class="table table-striped table-bordered table-hover">
        <tr>
            <th>#</th>
            <th>Rule</th>
            <th>Category</th>
            <th>Source</th>
            <th>Version</th>
            <th>State</th>
        </tr>
        {% for row in rule_list %}
        {% if row.state == 0 %}
        <tr class="success">
        {% elif row.state == 1 %}
        <tr class="danger">
        {% else %}
        <tr>
        {% endif %}

            <td>{{row.rule_id}}</td>
            <td><a href="/rule/{{row.rule_id}}/">{{row.name}}</a></td>
            <td>{{row.category}}</td>
            <td>{{row.source}}</td>
            <td>{{row.version}}</td>
            <td>{{row.active}}</td>
        </tr>
        {% endfor %}
    </table>
</div>


<div class="text-center">
    <nav>
        <ul class="pagination">
            {% if rule_list.has_previous %}
            <li><a href="?page={{ rule_list.previous_page_number }}&search_type={{search_type}}&search_word={{search_word}}">&laquo;</a></li>
            {% else %}
            <li class="disabled"><span><span aria-hidden="true">&laquo;</span></span></li>
            {% endif %}

            {% for page in rule_list.paginator.page_range %}
            {% spaceless %}
            <li
            {% if page == rule_list.number %}
            class="active"
            {% endif %}
            ><a href="?page={{ page }}&search_type={{search_type}}&search_word={{search_word}}">{{ page }}</a></li>
            {% endspaceless %}
            {% endfor %}

            {% if rule_list.has_next %}
            <li><a href="?page={{ rule_list.next_page_number }}&search_type={{search_type}}&search_word={{search_word}}">&raquo;</a></li>
            {% else %}
            <li class="disabled"><span><span aria-hidden="true">&raquo;</span></span></li>
            {% endif %}
        </ul>
    </nav>
</div>

{% endblock %}